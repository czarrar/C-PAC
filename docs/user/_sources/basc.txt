Bootstrap Analysis of Stable Clusters (BASC)
--------------------------------------------

Introduction & Background
^^^^^^^^^^^^^^^^^^^^^^^^^
Bootstrap analysis of stable clusters (BASC) is a statistical framework to quantify the stability of resting state networks (RSNs) or how stable would the RSNs be during the following replication experiment (Bellec et al., 2010). The core of the method is bootstrapping the available datasets to replicate the clustering process a large number of times and quantify the stable features across all replications. It can be implemented in a multi-level fashion to investigate stable RSNs at the level of individual subjects and at the level of a group. 

Computation and Analysis Considerations
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
BASC can be applied to 4-D timeseries data in nifti format after preprocessing and being normalized to MNI space. Masks of region of interests (ROIs) are selected according to the primary interests of the user.

Individual-level BASC Computation:

#. For each subject, bootstrapping is applied to the original 4D dataset within the ROIs, resulting in B (number of bootstraps) replicated 4D dataset.

#. A clustering algorithm is then applied to each of the replicated dataset and resulted in B adjacency matrices.

#. All adjacency matrices are then averaged to a stability matrix which quantifies the stabile features of the clustering process.

Group-level BASC Computation:
The group-level BASC is based on the results of the individual-level BASC.

#. Bootstraping is applied to the individual stability matrices of the full sample (all subjects within that group) to mimic the random variations of the subject recruitment. Subjects were drawn with replacement from the real sample to generate a surrogate dataset featuring the same number of subjects as the original. This procedure resulted in C (number of bootstraps) replicated samples.

#. Within each replication sample, individual stability matrices of all subjects were averaged to an average individual stability matrix.

#. A clustering algorithm is then applied to each average individual stability matrix to generate a group-level adjacency matrix.

#. All group-level adjacency matrices are then averaged to a group stability matrix which depicts how stable two voxels belong to the same cluster.

#. The group stability matrix is then fed in a clustering algorithm to derive stable clusters.
The stable clusters do not convey by themselves any quantitative information regarding stability. A stability map can be constructed for a given cluster based on the stability matrix to depict how stable that a voxel belong to that cluster. The stability map can be derived both at the individual (Fig.1: Panel A) and group (Fig.1: Panel B) levels. 

The figure below (taken from Garcia-Garcia et al.) shows a visual representation of these steps.

.. figure:: /images/basc_manu_schematic.png

Please see developer workflow documentation for detailed calculation steps.

Applications and Recommendations
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Recently, the reproducibility and test-retest reliability of BASC have been tested   (Garcia-Garcia et al., in preparation). This framework has also been used to examine similarities and differences in striatal organization between children with ADHD and typically developing children (TDC) (Garcia-Garcia et al., 2012).

The most important parameters are the individual and group level number of clusters. Other parameters include the number of bootstrap at the individual and group level and minimum threshold for similarity matrix based on correlation to create an edge. Please see Bellec et al., 2010 for choice of the BASC parameters.

References
^^^^^^^^^^
Bellec, P. Rosa-Neto, O. C. Lyttelton, H. Benali, and A. C. Evans, “Multi-level bootstrap analysis of stable clusters in resting-state fMRI.,” NeuroImage, vol. 51, no. 3, pp. 1126-39, Jul. 2010.

Manuel Garcia-Garcia, Brian Cheung, Adriana Di Martino, Pierre Bellec, Clare Kelly, F. Xavier Castellanos, Michael Milham. Stability of Functional Connectivity networks in the Basal Ganglia in ADHD. Poster. 2012.

Garcia-Garcia, M., Bellec, P., Craddock, C., Cheung, B., Zuo, X-N., Kelly, C., Di Martino, A., Castellanos, F.X., and Milham, M.P. Individual stability of resting-state functional units: a new reliable tool.
